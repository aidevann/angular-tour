!function(t,e,n){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(t){t.put("tour/tour.tpl.html",'<div class="tour-tip">\n    <span class="tour-arrow tt-{{ ttPlacement }}" ng-hide="centered"></span>\n    <div class="tour-content-wrapper">\n        <h3 ng-bind="ttTitle"></h3>\n        <p ng-bind="ttContent"></p>\n        <a ng-click="proceed()" ng-bind="ttNextLabel" class="small button tour-next-tip"></a>\n        <a ng-click="closeTour()" class="tour-close-tip">&times;</a>\n    </div>\n</div>\n')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:500,margin:28,backDrop:!1,useSourceScope:!1,containerElement:"body",scrolling:!1}).controller("TourController",["$scope","orderedList",function(t,e){var n=this,r=n.steps=e(),o=!0;n.postTourCallback=angular.noop,n.postStepCallback=angular.noop,n.showStepCallback=angular.noop,n.currentStep=-1,t.$watch(function(){return n.currentStep},function(t){o?o=!1:n.select(t)}),n.select=function(t){if(angular.isNumber(t)){n.unselectAllSteps();var e=r.get(t);e&&(e.ttOpen=!0),n.currentStep!==t&&(n.currentStep=t),n.currentStep>-1&&n.showStepCallback(),t>=r.getCount()&&n.postTourCallback(!0),n.postStepCallback()}},n.addStep=function(t){angular.isNumber(t.index)&&!isNaN(t.index)?r.set(t.index,t):r.push(t)},n.unselectAllSteps=function(){r.forEach(function(t){t.ttOpen=!1})},n.cancelTour=function(){n.unselectAllSteps(),n.postTourCallback(!1)},t.openTour=function(){var t=n.currentStep>=r.getCount()||n.currentStep<0?0:n.currentStep;n.select(t)},t.closeTour=function(){n.cancelTour()}}]).directive("tour",["$parse","$timeout","tourConfig",function(t,e,n){return{controller:"TourController",restrict:"EA",scope:!0,link:function(r,o,a,i){if(!angular.isDefined(a.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";var l=t(a.step),u=!1;r.$watch(a.step,function(t){i.currentStep=t}),i.postTourCallback=function(t){angular.element(".tour-backdrop").remove(),u=!1,angular.element(".tour-element-active").removeClass("tour-element-active"),t&&angular.isDefined(a.tourComplete)&&r.$parent.$eval(a.tourComplete),angular.isDefined(a.postTour)&&r.$parent.$eval(a.postTour)},i.postStepCallback=function(){angular.isDefined(a.postStep)&&r.$parent.$eval(a.postStep)},i.showStepCallback=function(){n.backDrop&&(angular.element(n.containerElement).append(angular.element('<div class="tour-backdrop"></div>')),e(function(){$(".tour-backdrop").remove(),angular.element('<div class="tour-backdrop"></div>').insertBefore(".tour-tip")},1e3),u=!0)},r.setCurrentStep=function(t){l.assign(r.$parent,t),i.currentStep=t},r.getCurrentStep=function(){return i.currentStep}}}}]).directive("tourtip",["$window","$compile","$interpolate","$timeout","scrollTo","tourConfig","debounce","$q",function(e,r,o,a,i,l,u,c){var s=(o.startSymbol(),o.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,link:function(o,p,f,m){function d(){var t=o.ttElement?angular.element(o.ttElement):p,e=o;return t===p||o.ttSourceScope||(e=t.scope()),e}function g(e,n){var r,a,i=0,l=e[0].getBoundingClientRect(),u=l.top+t.pageYOffset,c=0;if(n&&n[0]){u=u-n[0].getBoundingClientRect().top+n[0].scrollTop,"fixed"===n.css("position")&&(c=n[0].getBoundingClientRect().left);var s=n[0].getBoundingClientRect().width;S.width()+l.width>s&&(r=s-l.left+o.ttMargin)}var p=S.width(),f=S.height();switch(o.ttPlacement){case"right":var m=l.left-c+l.width+o.ttMargin+o.offsetHorizontal;a={top:u+o.offsetVertical,left:m>0?m:i};break;case"bottom":var m=l.left-c+o.offsetHorizontal;a={top:u+l.height+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"center":var m=l.left-c+.5*(l.width-p)+o.offsetHorizontal;a={top:u+.5*(l.height-f)+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"center-top":var m=l.left-c+.5*(l.width-p)+o.offsetHorizontal;a={top:u+.1*(l.height-f)+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"left":var m=l.left-c-p-o.ttMargin+o.offsetHorizontal;a={top:u+o.offsetVertical,left:m>0?m:i,right:r};break;default:var m=l.left-c+o.offsetHorizontal;a={top:u-f-o.ttMargin+o.offsetVertical,left:m>0?m:i}}return a.top+="px",a.left+="px",a}function h(){if(o.ttContent){o.ttAnimation?S.fadeIn():S.css({display:"block"});var t=o.ttElement?angular.element(o.ttElement):p;if(null==t||0===t.length)throw"Target element could not be found. Selector: "+o.ttElement;angular.element(o.ttContainerElement).append(S);var r=function(){var e="body"===o.ttContainerElement?n:angular.element(o.ttContainerElement),r=g(t,e);S.css(r);var a=parseInt(r.top),u=parseInt(r.left);l.scrolling&&i(S,o.ttContainerElement,-150,-300,l.scrollSpeed,a,u)};if(l.backDrop&&b(t),angular.element(e).bind("resize."+o.$id,u(r,50)),r(),o.onStepShow){var c=d();a(function(){c.$eval(o.onStepShow)},300)}}}function v(){S.detach(),angular.element(e).unbind("resize."+o.$id)}function b(t){angular.element(".tour-element-active").removeClass("tour-element-active"),o.centered||t.addClass("tour-element-active")}f.$observe("tourtip",function(t){o.ttContent=t}),f.$observe("tourtipPlacement",function(t){o.ttPlacement=(t||l.placement).toLowerCase().trim(),o.centered=0===o.ttPlacement.indexOf("center")}),f.$observe("tourtipNextLabel",function(t){o.ttNextLabel=t||l.nextLabel}),f.$observe("tourtipContainerElement",function(t){o.ttContainerElement=t||l.containerElement}),f.$observe("tourtipMargin",function(t){o.ttMargin=parseInt(t,10)||l.margin}),f.$observe("tourtipOffsetVertical",function(t){o.offsetVertical=parseInt(t,10)||0}),f.$observe("tourtipOffsetHorizontal",function(t){o.offsetHorizontal=parseInt(t,10)||0}),f.$observe("onShow",function(t){o.onStepShow=t||null}),f.$observe("onProceed",function(t){o.onStepProceed=t||null}),f.$observe("tourtipElement",function(t){o.ttElement=t||null}),f.$observe("tourtipTitle",function(t){o.ttTitle=t||null}),f.$observe("useSourceScope",function(t){o.ttSourceScope=t?"true"===t:l.useSourceScope}),o.ttNextLabel=l.nextLabel,o.ttContainerElement=l.containerElement,o.ttPlacement=l.placement.toLowerCase().trim(),o.centered=!1,o.ttMargin=l.margin,o.offsetHorizontal=0,o.offsetVertical=0,o.ttSourceScope=l.useSourceScope,o.ttOpen=!1,o.ttAnimation=l.animation,o.index=parseInt(f.tourtipStep,10);var S=r(s)(o);m.addStep(o),a(function(){o.$watch("ttOpen",function(t){t?h():v()})},500),o.$on("$destroy",function(){angular.element(e).unbind("resize."+o.$id),S.remove(),S=null}),o.proceed=function(){if(o.onStepProceed){var t=d(),e=t.$eval(o.onStepProceed);c.resolve(e).then(function(){o.setCurrentStep(o.getCurrentStep()+1)})}else o.setCurrentStep(o.getCurrentStep()+1)}}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:!0,restrict:"EA",link:function(t,e,n){}}}).factory("orderedList",function(){var t=function(){this.map={},this._array=[]};t.prototype.set=function(t,e){if(angular.isNumber(t))if(t in this.map)this.map[t]=e;else{if(t<this._array.length){var n=t-1>0?t-1:0;this._array.splice(n,0,t)}else this._array.push(t);this.map[t]=e,this._array.sort(function(t,e){return t-e})}},t.prototype.indexOf=function(t){for(var e in this.map)if(this.map.hasOwnProperty(e)&&this.map[e]===t)return Number(e)},t.prototype.push=function(t){var e=this._array[this._array.length-1]+1||0;this._array.push(e),this.map[e]=t,this._array.sort(function(t,e){return t-e})},t.prototype.remove=function(t){var e=this._array.indexOf(t);if(-1===e)throw new Error("key does not exist");this._array.splice(e,1),delete this.map[t]},t.prototype.get=function(t){return this.map[t]},t.prototype.getCount=function(){return this._array.length},t.prototype.forEach=function(t){for(var e,n,r=0;r<this._array.length;r++)e=this._array[r],n=this.map[e],t(n,e)},t.prototype.first=function(){var t,e;return t=this._array[0],e=this.map[t]};var e=function(){return new t};return e}).factory("scrollTo",function(){return function(t,e,n,r,o,a,i){t?(n=n||-100,r=r||-100,o=o||500,$("html,"+e).stop().animate({scrollTop:a+n,scrollLeft:i+r},o)):$("html,"+e).stop().animate({scrollTop:0},o)}}).factory("debounce",["$timeout","$q",function(t,e){return function(n,r,o){var a,i=e.defer();return function(){var l=this,u=arguments,c=function(){a=null,o||(i.resolve(n.apply(l,u)),i=e.defer())},s=o&&!a;return a&&t.cancel(a),a=t(c,r),s&&(i.resolve(n.apply(l,u)),i=e.defer()),i.promise}}}])}(window,document);
